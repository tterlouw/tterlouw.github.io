<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Azure Application Gateway - Interactive Infographic</title>
    <style>
        :root {
            --primary-color: #0078D4;
            --secondary-color: #50E6FF;
            --tertiary-color: #243A5E;
            --background-color: #F7F9FA;
            --box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            --hover-color: #005A9E;
            --transition: all 0.3s ease;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: var(--background-color);
            color: #333;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        h1 {
            color: var(--primary-color);
            margin-bottom: 10px;
        }
        
        .intro {
            max-width: 800px;
            margin: 0 auto 40px;
            text-align: center;
            line-height: 1.6;
        }
        
        .infographic {
            position: relative;
            background-color: white;
            border-radius: 8px;
            box-shadow: var(--box-shadow);
            padding: 40px;
            overflow: hidden;
            min-height: 600px;
        }
        
        .component {
            position: absolute;
            background-color: white;
            border: 2px solid var(--primary-color);
            border-radius: 8px;
            padding: 15px;
            width: 180px;
            text-align: center;
            box-shadow: var(--box-shadow);
            transition: var(--transition);
            cursor: pointer;
            z-index: 10;
        }
        
        .component:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.15);
            border-color: var(--hover-color);
        }
        
        .component.active {
            background-color: var(--primary-color);
            color: white;
            transform: translateY(-5px);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
        }
        
        .component h3 {
            font-size: 16px;
            margin-bottom: 8px;
        }
        
        .component-icon {
            font-size: 32px;
            margin-bottom: 10px;
            color: var(--primary-color);
        }
        
        .active .component-icon {
            color: white;
        }
        
        .connection {
            position: absolute;
            background-color: var(--primary-color);
            z-index: 5;
            opacity: 0.5;
            transition: var(--transition);
        }
        
        .connection.active {
            background-color: var(--secondary-color);
            opacity: 0.8;
        }
        
        .detail-panel {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background-color: var(--tertiary-color);
            color: white;
            padding: 20px;
            transform: translateY(100%);
            transition: var(--transition);
            z-index: 15;
        }
        
        .detail-panel.show {
            transform: translateY(0);
        }
        
        .detail-panel h2 {
            margin-bottom: 15px;
            color: var(--secondary-color);
        }
        
        .detail-panel p {
            margin-bottom: 10px;
            line-height: 1.5;
        }
        
        .detail-panel ul {
            margin-left: 25px;
            margin-bottom: 15px;
        }
        
        .detail-panel li {
            margin-bottom: 5px;
        }
        
        .close-btn {
            position: absolute;
            top: 15px;
            right: 15px;
            background: none;
            border: none;
            color: white;
            font-size: 20px;
            cursor: pointer;
        }
        
        .controls {
            display: flex;
            justify-content: center;
            margin: 30px 0;
            gap: 15px;
        }
        
        .control-btn {
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: 4px;
            padding: 10px 15px;
            cursor: pointer;
            transition: var(--transition);
        }
        
        .control-btn:hover {
            background-color: var(--hover-color);
        }
        
        .legend {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-top: 30px;
            flex-wrap: wrap;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 4px;
        }
        
        @media (max-width: 768px) {
            .infographic {
                padding: 20px;
                transform: scale(0.8);
                transform-origin: top center;
            }
            
            .controls {
                flex-direction: column;
                align-items: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Azure Application Gateway: Interactive Infographic</h1>
            <p class="intro">
                Explore how Azure Application Gateway components work together to route and secure your web traffic. Click on any component to learn more about its role, features, and how it connects to other parts of the system.
            </p>
        </header>
        
        <div class="controls">
            <button class="control-btn" id="showAll">Show All Connections</button>
            <button class="control-btn" id="resetView">Reset View</button>
            <button class="control-btn" id="showFlow">Show Traffic Flow</button>
        </div>
        
        <div class="infographic">
            <!-- Components will be added here dynamically -->
            
            <div class="detail-panel" id="detailPanel">
                <button class="close-btn" id="closePanel">√ó</button>
                <h2 id="detailTitle">Component Title</h2>
                <div id="detailContent">
                    Component details will appear here.
                </div>
            </div>
        </div>
        
        <div class="legend">
            <div class="legend-item">
                <div class="legend-color" style="background-color: #0078D4;"></div>
                <span>Component</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background-color: #50E6FF;"></div>
                <span>Active Connection</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background-color: #243A5E;"></div>
                <span>Detail Panel</span>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Define components with positions, connections, and details
            const components = [
                {
                    id: 'internet',
                    name: 'Internet',
                    icon: 'üåê',
                    left: '10%',
                    top: '40%',
                    details: `
                        <p>The entry point for all client traffic heading toward your application.</p>
                        <h3>Key Aspects:</h3>
                        <ul>
                            <li>Source of client requests</li>
                            <li>External user traffic origin</li>
                        </ul>
                        <p>All client requests from the internet first reach the Azure Application Gateway's frontend IP configuration.</p>
                    `
                },
                {
                    id: 'frontend',
                    name: 'Frontend IP Configuration',
                    icon: 'üì°',
                    left: '25%',
                    top: '20%',
                    details: `
                        <p>The public or private IP interface that clients connect to when accessing the Application Gateway.</p>
                        <h3>Features:</h3>
                        <ul>
                            <li>Can have public and/or private IP addresses</li>
                            <li>Supports multiple IP configurations</li>
                            <li>Entry point for all application traffic</li>
                        </ul>
                        <p>Frontend IP configurations can be configured as public IP addresses for internet-facing applications or as private IP addresses for internal applications.</p>
                    `
                },
                {
                    id: 'listeners',
                    name: 'Listeners',
                    icon: 'üëÇ',
                    left: '25%',
                    top: '60%',
                    details: `
                        <p>Listeners check for client connection requests on specific protocol, port, and hostname combinations.</p>
                        <h3>Types:</h3>
                        <ul>
                            <li><strong>Basic Listener</strong>: Routes all requests on a specific port/protocol to a backend pool</li>
                            <li><strong>Multi-site Listener</strong>: Routes requests based on host headers (multiple domains on same IP/port)</li>
                        </ul>
                        <h3>Features:</h3>
                        <ul>
                            <li>Support for HTTP and HTTPS protocols</li>
                            <li>SSL termination capabilities</li>
                            <li>Can associate with WAF policy</li>
                        </ul>
                        <p>Listeners are configured to accept specific types of connections, and then direct traffic based on rules.</p>
                    `
                },
                {
                    id: 'rules',
                    name: 'Routing Rules',
                    icon: 'üîÄ',
                    left: '45%',
                    top: '40%',
                    details: `
                        <p>Rules determine how traffic should be routed from listeners to backend pools.</p>
                        <h3>Types:</h3>
                        <ul>
                            <li><strong>Basic Rules</strong>: Route all traffic from a listener to a specific backend pool</li>
                            <li><strong>Path-based Rules</strong>: Route traffic based on URL path patterns (e.g., /images/* to one pool, /api/* to another)</li>
                        </ul>
                        <h3>Key Features:</h3>
                        <ul>
                            <li>URL rewriting capabilities</li>
                            <li>HTTP header modification</li>
                            <li>Association with HTTP settings</li>
                        </ul>
                        <p>Rules are the critical decision-making components that implement your routing logic.</p>
                    `
                },
                {
                    id: 'waf',
                    name: 'Web Application Firewall',
                    icon: 'üõ°Ô∏è',
                    left: '45%',
                    top: '15%',
                    details: `
                        <p>WAF provides centralized protection for your web applications against common exploits and vulnerabilities.</p>
                        <h3>Protection Against:</h3>
                        <ul>
                            <li>SQL injection attacks</li>
                            <li>Cross-site scripting (XSS)</li>
                            <li>Command injection</li>
                            <li>HTTP protocol violations</li>
                            <li>Other OWASP Top 10 vulnerabilities</li>
                        </ul>
                        <h3>Modes:</h3>
                        <ul>
                            <li><strong>Detection</strong>: Logs threats but doesn't block them</li>
                            <li><strong>Prevention</strong>: Actively blocks detected threats</li>
                        </ul>
                        <p>WAF integrates with Azure Security Center for comprehensive security monitoring and protection.</p>
                    `
                },
                {
                    id: 'httpSettings',
                    name: 'HTTP Settings',
                    icon: '‚öôÔ∏è',
                    left: '65%',
                    top: '25%',
                    details: `
                        <p>HTTP Settings define how the Application Gateway communicates with the backend pools.</p>
                        <h3>Configurable Options:</h3>
                        <ul>
                            <li>Protocol (HTTP/HTTPS)</li>
                            <li>Port</li>
                            <li>Cookie-based session affinity</li>
                            <li>Connection draining</li>
                            <li>Request timeout</li>
                            <li>Custom health probes</li>
                        </ul>
                        <p>HTTP Settings can also handle authentication certificates for backend HTTPS connections, enabling end-to-end SSL encryption.</p>
                    `
                },
                {
                    id: 'backendPools',
                    name: 'Backend Pools',
                    icon: 'üñ•Ô∏è',
                    left: '65%',
                    top: '55%',
                    details: `
                        <p>Backend pools are logical groupings of your application servers that receive traffic from the Application Gateway.</p>
                        <h3>Supported Backend Types:</h3>
                        <ul>
                            <li>Virtual machines</li>
                            <li>Virtual machine scale sets</li>
                            <li>App Services</li>
                            <li>Public/Private IP addresses</li>
                            <li>Internal load balancers</li>
                            <li>Fully qualified domain names (FQDNs)</li>
                        </ul>
                        <p>You can configure multiple backend pools for different application components or environments, enabling complex routing scenarios.</p>
                    `
                },
                {
                    id: 'healthProbes',
                    name: 'Health Probes',
                    icon: '‚ù§Ô∏è',
                    left: '85%',
                    top: '40%',
                    details: `
                        <p>Health probes monitor the health of backend servers and automatically remove unhealthy instances from rotation.</p>
                        <h3>Configurable Options:</h3>
                        <ul>
                            <li>Protocol (HTTP/HTTPS)</li>
                            <li>Interval between probes</li>
                            <li>Path to probe</li>
                            <li>Timeout period</li>
                            <li>Unhealthy threshold (number of failures before marking server unhealthy)</li>
                            <li>Match specific status codes, body content</li>
                        </ul>
                        <p>Custom health probes can be configured to check specific application endpoints to verify correct functionality beyond simple server response.</p>
                    `
                },
                {
                    id: 'sslCerts',
                    name: 'SSL Certificates',
                    icon: 'üîí',
                    left: '35%',
                    top: '75%',
                    details: `
                        <p>SSL certificates enable secure HTTPS connections between clients and the Application Gateway.</p>
                        <h3>Certificate Usage:</h3>
                        <ul>
                            <li><strong>Listener Certificates</strong>: For client-to-gateway encryption (frontend)</li>
                            <li><strong>Authentication Certificates</strong>: For gateway-to-backend encryption validation</li>
                        </ul>
                        <h3>Certificate Management:</h3>
                        <ul>
                            <li>Upload PFX certificates directly</li>
                            <li>Integration with Azure Key Vault</li>
                            <li>Support for SNI (Server Name Indication) for multiple secure sites</li>
                        </ul>
                        <p>SSL Certificates enable end-to-end encryption for sensitive applications and compliance requirements.</p>
                    `
                },
                {
                    id: 'autoscaling',
                    name: 'Autoscaling',
                    icon: 'üìà',
                    left: '75%',
                    top: '75%',
                    details: `
                        <p>Autoscaling allows the Application Gateway to adjust capacity based on traffic load.</p>
                        <h3>Key Aspects:</h3>
                        <ul>
                            <li>Automatically scales out/in based on traffic patterns</li>
                            <li>Supports up to 125 instances (v2)</li>
                            <li>Eliminates the need to choose or change instance size/count</li>
                            <li>Provides predictable performance during variable traffic patterns</li>
                        </ul>
                        <p>Autoscaling is a feature of Application Gateway v2 SKU, providing better performance and cost efficiency for variable workloads.</p>
                    `
                }
            ];
            
            // Define connections between components
            const connections = [
                { from: 'internet', to: 'frontend', description: 'Client requests' },
                { from: 'internet', to: 'listeners', description: 'Client requests' },
                { from: 'frontend', to: 'listeners', description: 'Traffic forwarding' },
                { from: 'listeners', to: 'waf', description: 'Security scanning' },
                { from: 'listeners', to: 'rules', description: 'Routing decision' },
                { from: 'rules', to: 'httpSettings', description: 'Backend communication' },
                { from: 'rules', to: 'backendPools', description: 'Target selection' },
                { from: 'httpSettings', to: 'backendPools', description: 'Request forwarding' },
                { from: 'backendPools', to: 'healthProbes', description: 'Health monitoring' },
                { from: 'listeners', to: 'sslCerts', description: 'Secure communication' },
                { from: 'httpSettings', to: 'sslCerts', description: 'Backend encryption' },
                { from: 'backendPools', to: 'autoscaling', description: 'Capacity adjustment' }
            ];
            
            const infographic = document.querySelector('.infographic');
            const detailPanel = document.getElementById('detailPanel');
            const detailTitle = document.getElementById('detailTitle');
            const detailContent = document.getElementById('detailContent');
            const closePanel = document.getElementById('closePanel');
            const showAllBtn = document.getElementById('showAll');
            const resetViewBtn = document.getElementById('resetView');
            const showFlowBtn = document.getElementById('showFlow');

            // Create components
            components.forEach(comp => {
                const componentEl = document.createElement('div');
                componentEl.className = 'component';
                componentEl.id = comp.id;
                componentEl.innerHTML = `
                    <div class="component-icon">${comp.icon}</div>
                    <h3>${comp.name}</h3>
                `;
                componentEl.style.left = comp.left;
                componentEl.style.top = comp.top;
                
                componentEl.addEventListener('click', () => {
                    showComponentDetails(comp);
                });
                
                infographic.appendChild(componentEl);
            });
            
            // Create connections
            connections.forEach((conn, index) => {
                createConnection(conn.from, conn.to, index);
            });
            
            // Functions
            function showComponentDetails(component) {
                // Highlight active component
                document.querySelectorAll('.component').forEach(el => {
                    el.classList.remove('active');
                });
                document.getElementById(component.id).classList.add('active');
                
                // Highlight related connections
                document.querySelectorAll('.connection').forEach(el => {
                    el.classList.remove('active');
                });
                
                connections.forEach((conn, index) => {
                    if (conn.from === component.id || conn.to === component.id) {
                        document.getElementById(`connection-${index}`).classList.add('active');
                    }
                });
                
                // Update and show detail panel
                detailTitle.textContent = component.name;
                detailContent.innerHTML = component.details;
                detailPanel.classList.add('show');
            }
            
            function createConnection(fromId, toId, index) {
                const from = document.getElementById(fromId);
                const to = document.getElementById(toId);
                
                // Wait for elements to be available in the DOM
                if (!from || !to) {
                    setTimeout(() => createConnection(fromId, toId, index), 100);
                    return;
                }
                
                const connEl = document.createElement('div');
                connEl.className = 'connection';
                connEl.id = `connection-${index}`;
                
                const fromRect = from.getBoundingClientRect();
                const toRect = to.getBoundingClientRect();
                const infographicRect = infographic.getBoundingClientRect();
                
                // Calculate relative positions
                const fromX = fromRect.left - infographicRect.left + fromRect.width/2;
                const fromY = fromRect.top - infographicRect.top + fromRect.height/2;
                const toX = toRect.left - infographicRect.left + toRect.width/2;
                const toY = toRect.top - infographicRect.top + toRect.height/2;
                
                // Calculate connection line properties
                const length = Math.sqrt(Math.pow(toX - fromX, 2) + Math.pow(toY - fromY, 2));
                const angle = Math.atan2(toY - fromY, toX - fromX) * 180 / Math.PI;
                
                // Apply styles
                connEl.style.width = `${length}px`;
                connEl.style.height = '3px';
                connEl.style.left = `${fromX}px`;
                connEl.style.top = `${fromY}px`;
                connEl.style.transform = `rotate(${angle}deg)`;
                connEl.style.transformOrigin = 'left center';
                
                infographic.appendChild(connEl);
            }
            
            // Event listeners
            closePanel.addEventListener('click', () => {
                detailPanel.classList.remove('show');
                document.querySelectorAll('.component').forEach(el => {
                    el.classList.remove('active');
                });
                document.querySelectorAll('.connection').forEach(el => {
                    el.classList.remove('active');
                });
            });
            
            showAllBtn.addEventListener('click', () => {
                document.querySelectorAll('.connection').forEach(el => {
                    el.classList.add('active');
                });
            });
            
            resetViewBtn.addEventListener('click', () => {
                document.querySelectorAll('.component').forEach(el => {
                    el.classList.remove('active');
                });
                document.querySelectorAll('.connection').forEach(el => {
                    el.classList.remove('active');
                });
                detailPanel.classList.remove('show');
            });
            
            let currentFlowStep = 0;
            const trafficFlow = [
                'internet',
                'frontend',
                'listeners',
                'waf',
                'rules',
                'httpSettings',
                'backendPools',
                'healthProbes'
            ];
            
            showFlowBtn.addEventListener('click', () => {
                // Reset view first
                resetViewBtn.click();
                
                // Show traffic flow animation
                animateTrafficFlow();
            });
            
            function animateTrafficFlow() {
                if (currentFlowStep < trafficFlow.length) {
                    const componentId = trafficFlow[currentFlowStep];
                    const component = components.find(c => c.id === componentId);
                    
                    showComponentDetails(component);
                    
                    currentFlowStep++;
                    setTimeout(animateTrafficFlow, 1500);
                } else {
                    currentFlowStep = 0;
                }
            }
            
            // Initial refresh of connections to ensure proper rendering
            setTimeout(() => {
                connections.forEach((conn, index) => {
                    const connElement = document.getElementById(`connection-${index}`);
                    if (connElement) {
                        infographic.removeChild(connElement);
                    }
                    createConnection(conn.from, conn.to, index);
                });
            }, 500);
            
            // Handle window resize
            window.addEventListener('resize', () => {
                connections.forEach((conn, index) => {
                    const connElement = document.getElementById(`connection-${index}`);
                    if (connElement) {
                        infographic.removeChild(connElement);
                    }
                    createConnection(conn.from, conn.to, index);
                });
            });
        });
    </script>
</body>
</html>
